---
layout: post
title: "TIL web server, socket"
categories: [ TIL ]
permalink: /TIL/:year/:month/:day/:title/
---

# 2021-05-07 {{page.title}}
&nbsp;  

정적 파일이 포함된 배포를 하려고 Nginx와 uWSGI를 사용해 헤딩하면서 들었던 의문이 있다. 정적 파일 없는 배포를 했을 땐 gunicorn만으로도 됐는데 어떤 차이인지. 찾아봤는데 Web server - WSGI - Web application으로 이어지는 가장 기본적인 형태로 정적 요청도 동적 요청도 처리할 수 있다는 건 알겠다. 근데 이 WSGI 구현체들은 무슨 귀에 걸면 귀걸이 코에 걸면 코걸이... middleware랬다가 웹 서버 역할도 할 수 있댔다가... 누구는 WSGI 자체를 WAS라고 불렀다가 CGI라 했다가(용어 정리가 필요하다. 뭐가 맞는지 틀린지.). gunicorn만 쓸 때는 이게 Web Server인 줄 알았다. 그리고 그게 맞는데 아니기도 하다는 소린지... 얘가 어쨌든 django의 wsgi 파일을 쓰니까 Web server - WSGI - Web application 구조인 줄 알았단 말이다. 지금은 긴지 아닌지 모르겠다. 회전 컵받침에 들어가서 돌돌 돌려진 느낌이니까 일단 자고 내일 django.core.wsgi 탐험하기. 이 찝찝함을 해결해야 따릉이 프로젝트에서 배포 방법을 상의할 수 있을 것 같다.  
   
http 통신에 대해 얘기할 때는 요청-응답 전후에 연결과 연결 끊기가 존재한다는 걸 좀 더 잘 붙여야 겠다. 요청-응답 먼저 얘기하고 이게 요청-응답 한 번으로 끝이에요!는 설명으로 걸맞지 않다...  
http 통신이 일방향, 소켓 통신이 양방향이라는 게 각각의 특징으로 꼽힌다. 나는 소켓이 통신 말단이라고만 알고 있었어서 소켓 통신이 http 통신과 어떻게 다른지 더 파봐야 차이를 알 수 있을 것 같다. 네트워크 계층 보고 다시 공부해야 겠다.  
  
내일은 어버이날. 좀 멀리 나가서 맛있는 거 포장해서 올 거다.  
그다음 따릉이 프로젝트에 필요한 거 몇가지 다시 볼 게 있다. 정보 뽑아올 서울시 API, crontab, transaction atomic. 다 기억 희미해진 것들.  
근데 이거 생각해 보니 배포 한 번은 해야 되는 마디인 것 같다. crontab을 EC2 상에서 돌리고 django 서버만 따로 python 3 이미지 기반으로 dockerize 할 건지 아니면 ubuntu 이미지 상에 두가지 다 넣어 놓고 굳힐 건지 확인 필요. 이제껏 전자로 생각하고 있어서 중간 배포 안 하는 걸로 합의했는데 생각해보니 예약 거는 거 자체도 같이 굳혀둘 수는 없는 걸까 하는 의문이 듦.